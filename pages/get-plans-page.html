<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../layouts/main-layout.html">

<link rel="import" href="../components/paper-input/paper-autogrow-textarea.html">
<link rel="import" href="../components/paper-input/paper-input-decorator.html">
<link rel="import" href="../components/paper-input/paper-input.html">
<link rel="import" href="../components/paper-button/paper-button.html">

<link rel="import" href="../elements/r2als-anchor-button.html">
<link rel="import" href="../elements/r2als-paper-action-dialog.html">

<link rel="import" href="../elements/get-plans/full-detail-view.html">
<link rel="import" href="../elements/get-plans/json-view.html">
<link rel="import" href="../elements/get-plans/compact-view.html">
<link rel="import" href="../elements/get-plans/cozy-view.html">

<link rel="import" href="../components/core-ajax/core-ajax.html">
<link rel="import" href="../components/paper-spinner/paper-spinner.html">
<link rel="import" href="../components/paper-tabs/paper-tabs.html">

<script src="../components/jquery/dist/jquery.min.js"></script>
<!--<script src="/components/jquery-validity/build/jquery.validity.min.js"></script>-->


<polymer-element name="get-plans-page">
  <template>
<!--        <link rel="stylesheet" href="../../external_components/joint.min.css" shim-shadowdom>-->

    <style>

      paper-spinner.blue::shadow .circle {
        border-color: #4285f4;
      }

      paper-spinner.red::shadow .circle {
        border-color: #db4437;
      }

      paper-spinner.yellow::shadow .circle {
        border-color: #f4b400;
      }

      paper-spinner.green::shadow .circle {
        border-color: #0f9d58;
      }
      
    paper-tabs, core-toolbar {
      background-color: #2196F3;
      color: #fff;
      box-shadow: 0px 3px 2px rgba(0, 0, 0, 0.2);
    }
/*
    paper-tabs a,
    paper-tabs a:link,
    paper-tabs a:visited,
    paper-tabs a:hover,
    paper-tabs a:active{
      color:inherit;
      text-decoration: inherit;
      padding: inherit;
      margin: inherit;
    }
 
*/
    core-toolbar paper-tabs {
      box-shadow: none;
    }
/*
    paper-tabs::shadow #selectionBar {
      background-color: #FF9800;
    }
    
*/
      .scroll{
/*        overflow: auto;*/
      }
      .header, .scroll{
        height: 100%;
      }
      .space-div{
        margin:20px
      }
    </style>
    <link rel="stylesheet" href="../css/main.css" shim-shadowdom>
    <main-layout selected="get-plans">
      <div class="title">Get Plans</div>
      <div class="header">
          <div class="bottom fit" horizontal layout>
    
            <paper-tabs selected="{{tabSelected}}" valueattr="name" flex>

              <paper-tab name="compact-view" on-tap="{{compactButHandler}}">COMPACT</paper-tab>
              <paper-tab name="full-detail-view" on-tap="{{fullButHandler}}">FULL DETAIL</paper-tab>
              <paper-tab name="cozy-view" on-tap="{{cozyButHandler}}">Cozy</paper-tab>
              <paper-tab name="json-view" on-tap="{{jsonButHandler}}">JSON</paper-tab>

            </paper-tabs>

        </div>
        <section>
          <paper-shadow>
            <div horizontal center-justified layout hidden?="{{!loading_layout}}">
              <div vertical layout >
                <h3 style="margin: 30px 0px 5px 0px; padding: 0px;">Do you like this plan? ( {{display_solution_id}} / {{solution_length}} )</h3>
      <!--            <p><paper-button raised on-tap="{{getNextSolution}}">No</paper-button> <paper-button raised class="colored">Yes</paper-button></p>-->
                    <p><paper-button raised on-tap="{{getPreviousSolution}}"><< Previous </paper-button><paper-button raised on-tap="{{refreshSolution}}">Refresh</paper-button><paper-button raised class="colored" on-tap="{{getNextSolution}}">Next >></paper-button></p>
              </div>
            </div>
          </paper-shadow>
        </section>
        
      </div>

<!--      <div class="header">-->
        <div class="scroll">
          <div horizontal center-justified layout hidden?="{{loading_layout}}">
            <paper-spinner id="loading" class="blue space-div" active></paper-spinner>
          </div>
          <div>
            <span id="compact_view"><compact-view data="{{current_plan}}" refresh="{{refresh}}"></compact-view></span>
            <span id="full_detail_view"><full-detail-view id="full_detail_view" data="{{current_plan}}" refresh="{{refresh}}"></full-detail-view></span>
            <span id="cozy_view"><cozy-view id="cozy_view" data="{{current_plan}}"></cozy-view></span>
            <span id="json_view"><json-view id="json_view" data="{{current_plan}}" refresh="{{refresh}}" input="{{input}}"></json-view></span>
          </div>
          
        </div>
<!--      </div>-->
      <core-ajax 
        auto 
        url="http://127.0.0.1:6543/apis/processor" 
        method='POST' 
        handleAs="json"
        on-core-response="{{handleResponse}}"
        on-core-error="{{handleError}}"
        body="{{json}}">
      </core-ajax>
      
 
<!--
      <template repeat="{{response.data.subjects}}">
        <div>{{name}}</div>
      </template>
-->

      
      
      <!--  message from server dialog    -->
      <r2als-paper-action-dialog heading="{{messageHeading}}" backdrop layered="false" id="messageDialog">
        <template repeat="{{mb in messageBody}}">
          <p>
            {{mb}}
          </p>
        </template>
        <paper-button dismissive autofocus class="colored">Close</paper-button>
      </r2als-paper-action-dialog>
      <!--  message from server dialog     -->  
    
    </main-layout>
  </template>

</polymer-element>


